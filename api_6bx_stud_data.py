"""
API 6BX Stud/Bolt Dimensions
All dimensions for standard API 6BX flanges
Diameter in inches, length in inches and millimeters
"""

# API 6BX 2000 PSI Stud Dimensions
API_6BX_2000_STUDS = {
    '26-3/4': {
        'size': '26-3/4',
        'rating_psi': 2000,
        'stud_diameter_inches': 1.75,
        'stud_diameter_mm': 44.45,
        'stud_length_inches': 14.25,
        'stud_length_mm': 365
    },
    '30': {
        'size': '30',
        'rating_psi': 2000,
        'stud_diameter_inches': 1.625,
        'stud_diameter_mm': 41.275,
        'stud_length_inches': 14.5,
        'stud_length_mm': 370
    },
}

# API 6BX 3000 PSI Stud Dimensions
API_6BX_3000_STUDS = {
    '26-3/4': {
        'size': '26-3/4',
        'rating_psi': 3000,
        'stud_diameter_inches': 2.0,
        'stud_diameter_mm': 50.8,
        'stud_length_inches': 17.5,
        'stud_length_mm': 445
    },
    '30': {
        'size': '30',
        'rating_psi': 3000,
        'stud_diameter_inches': 1.875,
        'stud_diameter_mm': 47.625,
        'stud_length_inches': 17.75,
        'stud_length_mm': 455
    },
}

# API 6BX 5000 PSI Stud Dimensions
API_6BX_5000_STUDS = {
    '13-5/8': {
        'size': '13-5/8',
        'rating_psi': 5000,
        'stud_diameter_inches': 1.625,
        'stud_diameter_mm': 41.275,
        'stud_length_inches': 12.75,
        'stud_length_mm': 325
    },
    '16-3/4': {
        'size': '16-3/4',
        'rating_psi': 5000,
        'stud_diameter_inches': 1.875,
        'stud_diameter_mm': 47.625,
        'stud_length_inches': 14.75,
        'stud_length_mm': 375
    },
    '18-3/4': {
        'size': '18-3/4',
        'rating_psi': 5000,
        'stud_diameter_inches': 2.0,
        'stud_diameter_mm': 50.8,
        'stud_length_inches': 17.75,
        'stud_length_mm': 455
    },
    '21-1/4': {
        'size': '21-1/4',
        'rating_psi': 5000,
        'stud_diameter_inches': 2.0,
        'stud_diameter_mm': 50.8,
        'stud_length_inches': 19.0,
        'stud_length_mm': 485
    },
}

# API 6BX 10000 PSI Stud Dimensions
API_6BX_10000_STUDS = {
    '1-13/16': {
        'size': '1-13/16',
        'rating_psi': 10000,
        'stud_diameter_inches': 0.75,
        'stud_diameter_mm': 19.05,
        'stud_length_inches': 5.5,
        'stud_length_mm': 140
    },
    '2-1/16': {
        'size': '2-1/16',
        'rating_psi': 10000,
        'stud_diameter_inches': 0.75,
        'stud_diameter_mm': 19.05,
        'stud_length_inches': 5.5,
        'stud_length_mm': 140
    },
    '2-9/16': {
        'size': '2-9/16',
        'rating_psi': 10000,
        'stud_diameter_inches': 0.875,
        'stud_diameter_mm': 22.225,
        'stud_length_inches': 6.5,
        'stud_length_mm': 170
    },
    '3-1/16': {
        'size': '3-1/16',
        'rating_psi': 10000,
        'stud_diameter_inches': 1.0,
        'stud_diameter_mm': 25.4,
        'stud_length_inches': 7.25,
        'stud_length_mm': 185
    },
    '4-1/16': {
        'size': '4-1/16',
        'rating_psi': 10000,
        'stud_diameter_inches': 1.125,
        'stud_diameter_mm': 28.575,
        'stud_length_inches': 8.5,
        'stud_length_mm': 220
    },
    '5-1/8': {
        'size': '5-1/8',
        'rating_psi': 10000,
        'stud_diameter_inches': 1.125,
        'stud_diameter_mm': 28.575,
        'stud_length_inches': 9.25,
        'stud_length_mm': 235
    },
    '7-1/16': {
        'size': '7-1/16',
        'rating_psi': 10000,
        'stud_diameter_inches': 1.5,
        'stud_diameter_mm': 38.1,
        'stud_length_inches': 11.75,
        'stud_length_mm': 300
    },
    '9': {
        'size': '9',
        'rating_psi': 10000,
        'stud_diameter_inches': 1.5,
        'stud_diameter_mm': 38.1,
        'stud_length_inches': 13.5,
        'stud_length_mm': 345
    },
    '11': {
        'size': '11',
        'rating_psi': 10000,
        'stud_diameter_inches': 1.75,
        'stud_diameter_mm': 44.45,
        'stud_length_inches': 15.25,
        'stud_length_mm': 390
    },
    '13-5/8': {
        'size': '13-5/8',
        'rating_psi': 10000,
        'stud_diameter_inches': 1.875,
        'stud_diameter_mm': 47.625,
        'stud_length_inches': 17.75,
        'stud_length_mm': 455
    },
    '16-3/4': {
        'size': '16-3/4',
        'rating_psi': 10000,
        'stud_diameter_inches': 1.875,
        'stud_diameter_mm': 47.625,
        'stud_length_inches': 17.75,
        'stud_length_mm': 455
    },
    '18-3/4': {
        'size': '18-3/4',
        'rating_psi': 10000,
        'stud_diameter_inches': 2.25,
        'stud_diameter_mm': 57.15,
        'stud_length_inches': 22.75,
        'stud_length_mm': 580
    },
    '21-1/4': {
        'size': '21-1/4',
        'rating_psi': 10000,
        'stud_diameter_inches': 2.5,
        'stud_diameter_mm': 63.5,
        'stud_length_inches': 24.75,
        'stud_length_mm': 630
    },
}

# API 6BX 15000 PSI Stud Dimensions
API_6BX_15000_STUDS = {
    '1-13/16': {
        'size': '1-13/16',
        'rating_psi': 15000,
        'stud_diameter_inches': 0.875,
        'stud_diameter_mm': 22.225,
        'stud_length_inches': 6.0,
        'stud_length_mm': 155
    },
    '2-1/16': {
        'size': '2-1/16',
        'rating_psi': 15000,
        'stud_diameter_inches': 0.875,
        'stud_diameter_mm': 22.225,
        'stud_length_inches': 6.5,
        'stud_length_mm': 170
    },
    '2-9/16': {
        'size': '2-9/16',
        'rating_psi': 15000,
        'stud_diameter_inches': 1.0,
        'stud_diameter_mm': 25.4,
        'stud_length_inches': 7.25,
        'stud_length_mm': 185
    },
    '3-1/16': {
        'size': '3-1/16',
        'rating_psi': 15000,
        'stud_diameter_inches': 1.125,
        'stud_diameter_mm': 28.575,
        'stud_length_inches': 8.0,
        'stud_length_mm': 205
    },
    '4-1/16': {
        'size': '4-1/16',
        'rating_psi': 15000,
        'stud_diameter_inches': 1.375,
        'stud_diameter_mm': 34.925,
        'stud_length_inches': 9.75,
        'stud_length_mm': 250
    },
    '5-1/8': {
        'size': '5-1/8',
        'rating_psi': 15000,
        'stud_diameter_inches': 1.5,
        'stud_diameter_mm': 38.1,
        'stud_length_inches': 11.5,
        'stud_length_mm': 295
    },
    '7-1/16': {
        'size': '7-1/16',
        'rating_psi': 15000,
        'stud_diameter_inches': 1.5,
        'stud_diameter_mm': 38.1,
        'stud_length_inches': 13.0,
        'stud_length_mm': 335
    },
    '9': {
        'size': '9',
        'rating_psi': 15000,
        'stud_diameter_inches': 1.875,
        'stud_diameter_mm': 47.625,
        'stud_length_inches': 16.0,
        'stud_length_mm': 410
    },
    '11': {
        'size': '11',
        'rating_psi': 15000,
        'stud_diameter_inches': 2.0,
        'stud_diameter_mm': 50.8,
        'stud_length_inches': 19.5,
        'stud_length_mm': 500
    },
    '13-5/8': {
        'size': '13-5/8',
        'rating_psi': 15000,
        'stud_diameter_inches': 2.25,
        'stud_diameter_mm': 57.15,
        'stud_length_inches': 21.25,
        'stud_length_mm': 540
    },
    '18-3/4': {
        'size': '18-3/4',
        'rating_psi': 15000,
        'stud_diameter_inches': 3.0,
        'stud_diameter_mm': 76.2,
        'stud_length_inches': 26.75,
        'stud_length_mm': 680
    },
}

# API 6BX 20000 PSI Stud Dimensions
API_6BX_20000_STUDS = {
    '1-13/16': {
        'size': '1-13/16',
        'rating_psi': 20000,
        'stud_diameter_inches': 1.0,
        'stud_diameter_mm': 25.4,
        'stud_length_inches': 7.75,
        'stud_length_mm': 200
    },
    '2-1/16': {
        'size': '2-1/16',
        'rating_psi': 20000,
        'stud_diameter_inches': 1.125,
        'stud_diameter_mm': 28.575,
        'stud_length_inches': 8.5,
        'stud_length_mm': 220
    },
    '2-9/16': {
        'size': '2-9/16',
        'rating_psi': 20000,
        'stud_diameter_inches': 1.25,
        'stud_diameter_mm': 31.75,
        'stud_length_inches': 9.5,
        'stud_length_mm': 245
    },
    '3-1/16': {
        'size': '3-1/16',
        'rating_psi': 20000,
        'stud_diameter_inches': 1.375,
        'stud_diameter_mm': 34.925,
        'stud_length_inches': 10.25,
        'stud_length_mm': 265
    },
    '4-1/16': {
        'size': '4-1/16',
        'rating_psi': 20000,
        'stud_diameter_inches': 1.75,
        'stud_diameter_mm': 44.45,
        'stud_length_inches': 12.5,
        'stud_length_mm': 320
    },
    '7-1/16': {
        'size': '7-1/16',
        'rating_psi': 20000,
        'stud_diameter_inches': 2.0,
        'stud_diameter_mm': 50.8,
        'stud_length_inches': 17.75,
        'stud_length_mm': 455
    },
    '9': {
        'size': '9',
        'rating_psi': 20000,
        'stud_diameter_inches': 2.5,
        'stud_diameter_mm': 63.5,
        'stud_length_inches': 21.75,
        'stud_length_mm': 555
    },
    '11': {
        'size': '11',
        'rating_psi': 20000,
        'stud_diameter_inches': 2.75,
        'stud_diameter_mm': 69.85,
        'stud_length_inches': 23.75,
        'stud_length_mm': 605
    },
    '13-5/8': {
        'size': '13-5/8',
        'rating_psi': 20000,
        'stud_diameter_inches': 3.0,
        'stud_diameter_mm': 76.2,
        'stud_length_inches': 29.75,
        'stud_length_mm': 760
    },
}

def get_api_6bx_stud_info(size, rating_psi):
    """
    Get API 6BX stud dimensions for a specific flange size and pressure rating.
    
    Args:
        size (str): Flange size (e.g., '1-13/16', '2-1/16', '13-5/8')
        rating_psi (int): Pressure rating (2000, 3000, 5000, 10000, 15000, or 20000)
    
    Returns:
        dict: Stud dimensions or None if not found
    """
    rating_map = {
        2000: API_6BX_2000_STUDS,
        3000: API_6BX_3000_STUDS,
        5000: API_6BX_5000_STUDS,
        10000: API_6BX_10000_STUDS,
        15000: API_6BX_15000_STUDS,
        20000: API_6BX_20000_STUDS,
    }
    
    stud_dict = rating_map.get(rating_psi)
    if stud_dict:
        return stud_dict.get(size)
    return None


def list_api_6bx_sizes(rating_psi):
    """
    List all available API 6BX flange sizes for a given pressure rating.
    
    Args:
        rating_psi (int): Pressure rating (2000, 3000, 5000, 10000, 15000, or 20000)
    
    Returns:
        list: Available flange sizes
    """
    rating_map = {
        2000: API_6BX_2000_STUDS,
        3000: API_6BX_3000_STUDS,
        5000: API_6BX_5000_STUDS,
        10000: API_6BX_10000_STUDS,
        15000: API_6BX_15000_STUDS,
        20000: API_6BX_20000_STUDS,
    }
    
    stud_dict = rating_map.get(rating_psi)
    if stud_dict:
        return sorted(stud_dict.keys())
    return []


# Example usage and testing
if __name__ == "__main__":
    print("API 6BX Stud Dimensions Database")
    print("=" * 60)
    
    # Test lookups
    test_cases = [
        ('1-13/16', 10000),
        ('13-5/8', 5000),
        ('26-3/4', 2000),
        ('30', 3000),
    ]
    
    for size, rating in test_cases:
        info = get_api_6bx_stud_info(size, rating)
        if info:
            print(f"\n{size}\" @ {rating} PSI:")
            print(f"  Stud Diameter: {info['stud_diameter_inches']}\" ({info['stud_diameter_mm']:.2f}mm)")
            print(f"  Stud Length: {info['stud_length_inches']}\" ({info['stud_length_mm']}mm)")
    
    # List all sizes by rating
    print("\n" + "=" * 60)
    print("Available sizes by pressure rating:")
    for rating in [2000, 3000, 5000, 10000, 15000, 20000]:
        sizes = list_api_6bx_sizes(rating)
        print(f"  {rating} PSI: {', '.join(sizes)}")
